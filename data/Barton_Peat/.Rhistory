library(Rmgr)
library(Rcmdr)
plotMeans(yield,fertilizer)
?plotmeans
?plotMeans
TukeyHDS(anova(lm(yield ~ fertilizer)))
TukeyHSD(anova(lm(yield ~ fertilizer)))
TukeyHSD(aov(yield ~ fertilizer)
)
?aov
?lm
?anova
?TukeyHSD.aov
?pairwise.t.test
aov1 <- aov(yield ~ fertilizer)
summary(aov1)
print(model.tables(aov1,"means"),digits=3)
str(aov1)
print(model.tables(aov1,"qr"),digits=3)
print(model.tables(aov1,"effects"),digits=3)
print(model.tables(aov1,"residuals"),digits=3)
?model.tables
plot(aov1)
stress <- read.csv("http://www.pmking.org/rmda/data/stress.csv")
str(stress)
boxplot(StressReduction ~ Treatment, data=stress)
boxplot(StressReduction ~ Age, data=stress)
boxplot(StressReduction ~ Age*Treatment, data=stress)
anova(stress)
anova(stressReduction ~ Treatment*Age,data=stress)
anova(lm(stressReduction ~ Treatment*Age,data=stress))
anova(lm(StressReduction ~ Treatment*Age,data=stress))
stress <- read.csv("http://www.pmking.org/rmda/data/stress.csv")
str(stress)
head(stress)
anova(lm(StressReduction ~ Treatment * Age, data = stress))
pairwise.t.test(stress$StressReduction, stress$Treatment, p.adj = "bonferroni")
pairwise.t.test(stress$StressReduction, stress$Age, p.adj = "bonferroni")
pairwise.t.test(folate, ventilation, p.adj="bonferroni")
0.0291*3
0.0291*2
pairwise.t.test(folate, ventilation, p.adj="bonferroni",paired=F)
?pairwise.t.test
0.2977*3
?TukeyHSD
qp(0.95,df1=2,df2=19)
qf(0.95,df1=2,df2=19)
rcf <- read.csv("http://www.pmking.org/rmda/data/red_cell_folate.csv")
f1 <- rcf$folate[rcf$ventilation=="N2O+O2,24h"]
f2 <- rcf$folate[rcf$ventilation=="N2O+O2,op"]
f3 <- rcf$folate[rcf$ventilation=="O2,24h"]
anova(lm(folate ~ ventilation, data = rcf))
stress <- read.csv("http://www.pmking.org/rmda/data/stress.csv")
str(stress)
head(stress)
anova(lm(StressReduction ~ Treatment * Age, data = stress))
boxplot(len ~ supp, data=ToothGrowth,las=1,xlab="Delivery Method",ylab="Tooth length / mm",col=c("cornflowerblue","olivedrab3"))
boxplot(len ~ dose, data=ToothGrowth,las=1,xlab="Dosage / mg",ylab="Tooth length / mm",col=c("cornflowerblue","olivedrab3","coral"))
plot(len ~ interaction(dose,supp), data=ToothGrowth,pas=1,ylab="Tooth  / mm")
anova(lm(len~supp*dose,data=ToothGrowth))
pairwise.t.test(ToothGrowth$len ~ ToothGrowth$supp*ToothGrowth$dose)
pairwise.t.test(ToothGrowth$len,ToothGrowth$supp*ToothGrowth$dose)
pairwise.t.test(ToothGrowth$len,ToothGrowth$supp)
pairwise.t.test(ToothGrowth$len,ToothGrowth$dose)
dose <- c(rep(0.0,8),rep(2.5,8),rep(5.0,8))
dose <- factor(dose,levels = (0.0,2.5,5.0),labels=c("low","medium","high")ordered = T)
dose <- factor(dose,levels = (0.0,2.5,5.0),labels=c("low","medium","high"),ordered = T)
dose <- factor(levels = (0.0,2.5,5.0),labels=c("low","medium","high"),ordered = T)
dose <- factor(dose, levels = c(0.0,2.5,5.0),labels=c("low","medium","high"),ordered = T)
dose
consumption <- c(112.6, 102.1, 90.2, 81.5, 105.6, 93.0, 106.6, 108.3, 73.3, 84.8, 67.3, 55.3, 80.7, 90.0, 75.5, 77.1,38.5, 81.3, 57.1, 62.3, 51.5, 48.3, 42.7, 57.9)
plot(consumption ~ dose)
scatterplot(consumption ~ dose,vertical=T,pch=20)
stripchart(consumption ~ dose,vertical=T,pch=20)
plot(consumption ~ dose)
stripchart(consumption ~ dose,vertical=T,pch=20,add=TRUE)
plot(consumption ~ dose, col=c("cornflowerblue","olivedrab2","coral"))
x <- c(60,69,66,64,54,67,59,65,63)
y <- c(136,198,194,140,93,172,116,174,145)
lm(y ~ x)
anova(lm(y ~ x))
summary(lm(y ~ x))
library(ISwR)
thuesen
3937 - 1921
3307 - 2517
birth_weight <- read.csv("http://www.pmking.org/rmda/data/birth_weight.csv")
dim(birth_weight) # view the dimensions of the data frame
str(birth_weight) # view the structure of the data frame
summary(birth_weight) # view a numerical summary of the dataframe
t.test(birth_weight$weight,mu = 3300)
uc <- read.csv("http://www.pmking.org/rmda/data/uterine_cramping.csv")
drug <- subset(uc,uc$patient=="drug") # get the data for the patients who took the drug
placebo <- subset(uc,uc$patient=="placebo")  # get the data for the patients who took the
t.test(drug$response,placebo$response,paired = FALSE)
pt(2.673,df=41.88)
1-pt(2.673,df=41.88)
pt(-2.673,df=41.88)
2*pt(-2.673,df=41.88)
gith <- read.csv("http://www.pmking.org/rmda/data/GITH.csv")
str(gith)
low <- subset(gith,diet=="low")
low
?subset
chromium <- read.csv("http://www.pmking.org/rmda/data/GITH.csv")
str(chromium)
low <- subset(chromium,diet=="low")
normal <- subset(chromium,diet=="normal")
boxplot(chromium$gith ~ chromium$diet)
shapiro.test(low$gith)
shapiro.test(normal$gith)
t.test(low$gith,normal$gith,paired=FALSE,alternative = "two.sided")
wilcox.test(low$gith,normal$gith,paired=FALSE,alternative = "two.sided")
install.packages("tikzDevice")
library(tikzDevice)
install.packages("plot3D")
barley <- rep(c(1,2,3,4),4)
barley
barley_random <- sample(barley,length(barley),replace = F)
barley_random
barley_random_matrix <- matrix(barley_random,nrow = 4,ncol = 4,byrow = T)
barley_random_matrix
rownames(barley_random_matrix) <- c("Plot 1","Plot 2","Plot 3", "Plot 4")
colnames(barley_random_matrix) <- c("Block 1","Block 2","Block 3", "Block 4")
barley_random_matrix
barley <- c(rep(sample(1:4,4,replace=F),4))
barley
barley <- c(sample(1:4,4,replace=F),4),sample(1:4,4,replace=F),4),sample(1:4,4,replace=F),4),sample(1:4,4,replace=F),4))
barley <- c(sample(1:4,4,replace=F),sample(1:4,4,replace=F),sample(1:4,4,replace=F),sample(1:4,4,replace=F))
barley
barley_matrix <- matrix(barley,nrow=4,ncol=4,byrow=F)
v <- c(5,10,20,5,10,15)
t <- c(1,1,1,2,2,2)
factor(t,levels = c(1,2),labels = c("Time 1", "Time 2"))
plot(v ~ t)
t
str(t)
v <- c(5,10,20,5,10,15)
t <- c(1,1,1,2,2,2)
t <- factor(t,levels = c(1,2),labels = c("Time 1", "Time 2"))
plot(v ~ t)
plot(0,0)
stripchart(v ~ t)
stripchart(v ~ t,vertical = T,pch=19)
stripchart(v ~ t,vertical = T,pch=19,las=1,xlab="Time",ylab="Rate")
locate()
identify()
segments(c(0,0,0),c(5,10,20),c(1,1,1),c(5,10,15))
v <- c(5,10,20,5,10,15)
t <- c(1,1,1,2,2,2)
t <- factor(t,levels = c(1,2),labels = c("Time 1", "Time 2"))
stripchart(v ~ t,vertical = T,pch=19,las=1,xlab="Time",ylab="Rate")
segments(c(0,0,0),c(5,10,20),c(1,1,1),c(5,10,15))
segments(c(1,1,1),c(5,10,20),c(2,2,2),c(5,10,15))
v <- c(5,10,20,5,10,15)
t <- c(1,1,1,2,2,2)
t <- factor(t,levels = c(1,2),labels = c("Time 1", "Time 2"))
stripchart(v ~ t,vertical = T,pch=19,las=1,xlab="Time",ylab="Rate")
segments(c(1,1,1),c(5,10,20),c(2,2,2),c(10,15,5))
text(1.5,17,"Mean Time 1 = 11.6")
v <- c(5,10,20,5,10,15)
t <- c(1,1,1,2,2,2)
t <- factor(t,levels = c(1,2),labels = c("Time 1", "Time 2"))
stripchart(v ~ t,vertical = T,pch=19,las=1,xlab="Time",ylab="Rate")
segments(c(1,1,1),c(5,10,20),c(2,2,2),c(10,15,5))
text(1.5,19,"Mean Time 1 = 11.6")
text(1.5,17.5,"Mean Time 2 = 10.0")
text(1.5,16,"Change = -1.6")
barplot(c(1,2),c(6,10))
barplot(c(1,2),c(6,10),width = 0.2)
barplot(c(1,1.5),c(6,10),width = 0.2,)
barplot(c(6,10),width = 0.2,)
barplot(c(6,10),width = 0.2,xlim=c(0,1))
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab2"))
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"))
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1)
barplotc((6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1)
barplotc(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1,ylim=c(4,10))
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1,ylim=c(4,10))
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1,ylim=c(4,10),xpd = 0)
par(mar=c(4,3,1,1),mfcol = c(1,2))
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1,ylim=c(4,10),xpd = 0)
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1)
par(mar=c(4,3,1,1),mfcol = c(1,2))
barplot(c(6,10),width = 0.2,xlim=c(0,2),col=c("coral","olivedrab3"),las=1,ylim=c(4,10),xpd = 0)
barplot(c(6,10),width = 0.2,xlim=c(0,1),col=c("coral","olivedrab3"),las=1)
plot.new()
x <- seq(-4,4,0.1)
y <- x*x
plot(x,y)
plot(x,y,axes = F)
plot(x,y,axes = F, type = "l")
axis(side = 1,tick = F)
axis(side = 1,tick = T)
axis(side = 2,tick = T)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
?plot.new
plot.new()
frame()
?frame
plot.window(xlim=c(0,5),ylim=(0,5))
plot.window(xlim=c(0,5),ylim=c(0,5))
curve(x*x)
plot.window(xlim=c(0,5),ylim=c(0,5))
curve(x*x,add=T)
?frame
frame()
plot.window(xlim=c(0,5),ylim=c(0,5))
curve(x*x,add=T)
curve(x*x,add=T)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
install.packages("xtable")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: cars
summary(cars)
plot(pressure)
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
# Chunk 2: cars
summary(cars)
shiny::runApp('tmp/Test')
shiny::runApp('tmp/Test')
update.packages("htmltools")
update.packages("htmltools")
lmfit <- lm(mpg ~ wt, mtcars)
lmfit
library(broom)
installed.packages("broom")
install.packages("broom")
library(broom)
install.packages("dplyr")
version
install.packages("installr")
install.packages("rmarkdown", type = "source")
install.packages("rmarkdown", type = "source")
knitr::opts_chunk$set(echo = TRUE)
# Chunk 1: setup
library(knitr)
library(ggplot2)
library(gridExtra)
opts_chunk$set(cache=TRUE,
error=FALSE,
message=FALSE,
warning=FALSE,
prompt=TRUE,
tidy=TRUE,
cache=TRUE,
strip.white=TRUE,
fig.path='figures/',
cache.path='cache/',
comment=NA,
size='scriptsize')
opts_knit$set(global.par=TRUE,
aliases = c(h = 'fig.height', w = 'fig.width'))
options(formatR.arrow=TRUE,width=90)
# Chunk 2: load-data
bdims <- read.csv("http://www.pmking.org/rmda/data/bdims.csv")
# Chunk 3: head-data
head(bdims)
# Chunk 4: male-female
male_dims <- subset(bdims, sex == 1)
female_dims <- subset(bdims, sex == 0)
# Chunk 5: female-hgt-mean-sd
fhgtmean <- mean(female_dims$hgt)
fhgtsd   <- sd(female_dims$hgt)
# Chunk 6: hist-height
par(cex=0.8)
hist(female_dims$hgt, probability = TRUE, las = 1, xlab = "Female Height / cm", ylim = c(0.0,0.06))
xvals <- 140:190
yvals <- dnorm(x = xvals, mean = fhgtmean, sd = fhgtsd)
lines(x = xvals, y = yvals, col = "blue")
# Chunk 7: qq
par(cex=0.8)
qqnorm(female_dims$hgt)
qqline(female_dims$hgt)
# Chunk 8: sim-norm
sim_norm <- rnorm(n = length(female_dims$hgt), mean = fhgtmean, sd = fhgtsd)
1 - pnorm(q = 182, mean = fhgtmean, sd = fhgtsd)
?selectInput
??selectInput
plot(x,y)
y <- rnorm(20)
x
y
x <- rnorm(20)
plot(x,y)
install.packages(c("abind", "colorspace", "digest", "e1071", "effects", "evaluate", "filehash", "formatR", "Formula", "gplots", "gridExtra", "gtable", "highr", "Hmisc", "ISwR", "lattice", "latticeExtra", "lmtest", "manipulate", "markdown", "multcomp", "munsell", "mvtnorm", "plot3D", "psych", "pwr", "R6", "Rcmdr", "RcmdrMisc", "RColorBrewer", "Rcpp", "relimp", "reshape2", "sandwich", "scales", "shiny", "stringr", "survival", "tcltk2", "TH.data", "tikzDevice", "xtable", "zoo"))
install.packages(c("Hmisc", "lmtest", "multcomp", "mvtnorm", "Rcmdr"))
install.packages(c("Hmisc", "lmtest", "multcomp", "mvtnorm", "Rcmdr"))
install.packages(c("Hmisc", "Rcmdr"))
library(openintro)
normTail()
update.packages("openintro")
install.packages("installR")
library(tikzDevice)
install.packages("tikzDevice")
library(knitr)
library(ggplot2)
library(gridExtra)
library(tikzDevice)
install.packages("tikzDevice")
install.packages("tikzDevice")
devtools::install_github("rstudio/addinexamples", type="source")
install.packages("devtools")
install.packages("devtools")
install.packages("curl")
install.packages("curl")
install.packages("devtools")
devtools::install_github("rstudio/addinexamples", type="source")
addinexamples:::subsetAddin()
addinexamples:::reformatAddin()
update.packages("openintro")
help(normTail)
??normTail
normTail()
library(openintro)
normTail(U=2)
?cat
?source
library(openintro)
treeDiag(main=c("Has HIV","Tests Positive"), p1=c(0.01,0.99), p2=list(c(0.997,0.003),c(0.015,0.985)), out1 = c("Yes", "No"), out2 = c("Yes", "No"),
textwd = 0.15, solwd = 0.3, SBS = c(TRUE, TRUE), showSol = TRUE,
solSub = NULL, digits = 4, textadj = 0.015, cex.main = 1.0,
col.main = "#999999", showWork = TRUE)
treeDiag(main=c("Has HIV","Tests Positive"), p1=c(0.01,0.99), p2=list(c(0.997,0.003),c(0.015,0.985)), out1 = c("Yes", "No"), out2 = c("Yes", "No"),
textwd = 0.15, solwd = 0.3, SBS = c(TRUE, TRUE), showSol = TRUE,
solSub = NULL, digits = 4, textadj = 0.015, cex.main = 1.1,
col.main = "#999999", showWork = TRUE)
source(selectInput())
source('~/Dropbox/Documents/Birkbeck/Modules/Current Modules/Research Methods and Data Analysis/2015-16/RMDA.R', encoding = 'UTF-8')
sample <- rnorm(1000)
pkCI(sample)
sample <- rnorm(1000)
pkCI(sample)
sample <- rnorm(1000)
pkCI(sample)
sample <- rnorm(100000)
pkCI(sample)
sample <- rnorm(100000)
pkCI(sample)
pkCI(sample,alpha=0.1)
pkCI(sample,alpha=0.5)
pknormTail()
pknormTail(l=0.3)
pknormTail(L=0.3)
pknormTail(L=0.3,col=COL[1])
pknormTail(L=0.3,col=COL[1],axes = 1)
pknormTail(L=0.3,col=COL[1],axes = 2)
pknormTail(L=0.3,col=COL[1],axes = symbol)
pknormTail(L=0.3,col=COL[1],axes = 'symbol')
data("run10")
histPlot(run10$time)
histPlot(run10$time,col=COL[1])
histPlot(run10$time[run10$gender==
'
M
'
], probability=TRUE, xlim=c(30, 180),
ylim=c(0, 0.025), hollow=TRUE)
histPlot(run10$time[run10$gender=='M'], probability=TRUE, xlim=c(30, 180),ylim=c(0, 0.025), hollow=TRUE)
histPlot(run10$time[run10$gender=='F'], probability=TRUE, add=TRUE,hollow=TRUE, lty=3, border='red')
histPlot(run10$time, col=fadeColor('yellow','33'), border='darkblue',probability=TRUE, breaks=30, lwd=3)
boxPlot(run10$time)
boxPlot(run10$time, run10$gender, col=fadeColor('black','22'))
data(tips)
par(mfrow=c(1,1))
boxPlot(tips$tip, tips$day, horiz=TRUE, key=c('Tuesday','Friday'))
dotPlot(tips$tip, tips$day, add=TRUE, at=1:2+0.05,
key=c(
'
Tuesday
'
,
'
Friday
'
))
data(tips)
par(mfrow=c(1,1))
boxPlot(tips$tip, tips$day, horiz=TRUE, key=c('Tuesday','Friday'))
dotPlot(tips$tip, tips$day, add=TRUE, at=1:2+0.05,key=c('Tuesday','Friday'))
densityPlot(run10$time, histo='faded', breaks=15, main='Run time')
densityPlot(run10$time, histo='faded', breaks=15, main='Run time')
densityPlot(run10$time, histo='hollow', breaks=30, fadingBorder='66',lty=1, main='Run time')
data(mlbBat10)
bat <- mlbBat10[mlbBat10$AB > 200,]
#edaPlot(bat)
data(mlbBat10)
bat <- mlbBat10[mlbBat10$AB > 200,]
edaPlot(bat)
setwd("~/Dropbox/Documents/Birkbeck/Modules/Current Modules/Research Methods and Data Analysis/2015-16/data/Barton_Peat")
read.spss()
library(foreign)
read.spss(file="asthma.sav")
asthma <- read.spss(file="asthma.sav")
asthma
read.spss(to.data.frame = TRUE,file="asthma.sav")
mydata <- read.spss(to.data.frame = TRUE,file="asthma.sav")
View(mydata)
rm(ls(*))
rm(ls())
rm(mydata,asthma)
mydata <- read.spss(file = "therapy.sav",to.data.frame = TRUE)
View(mydata)
rm(mydata)
mydata <- read.spss(file = "weights.sav",to.data.frame = TRUE)
View(mydata)
hist(mydata$weight)
hist(mydata$length)
qqplot(mydata$length)
qqline(mydata$length)
qqnorm(mydata$length)
str(mydata)
boxplot(mydata$gender ~ mydata$education)
male <- subset(mydata,gender=="Male")
female <- subset(mydata,gender=="Female")
male$education=="tertiary"
male$educatio=="tertiary"
sum(male$educatio=="tertiary")
sum(male$educatio=="year10")
sum(male$educatio=="year12")
weight <- mydata$weight
length <- mydata$length
headc <- mydata$headc
gender <- mydata$gender
education <- mydata$educatio
parity <- mydata$parity
births <- data.frame(weight,length,headc,gender,education,parity)
births
str(births)
write.csv(file="births.csv", row.names = FALSE)
write.csv(births, file="births.csv", row.names = FALSE)
weight <- round(mydata$weight,2)
births <- data.frame(weight,length,headc,gender,education,parity)
str(births)
write.csv(births, file="births.csv", row.names = FALSE)
ls
ls()
rm(ls())
rm(ls(*))
ls()
rm(ls()[1])
rm(births,education,female, gender,headc,length,male,mydata,parity,weight)
setwd("~/Dropbox/Documents/Birkbeck/Modules/Current Modules/Research Methods and Data Analysis/2015-16/data/Barton_Peat")
births <- read.csv("../births.csv")
View(births)
str(births)
hist(births$headc)
qqnorm(births$headc)
attach(births)
boxplot(headc ~ gender)
boxplot(weight ~ gender)
boxplot(weight ~ education)
boxplot(headc ~ education)
hist(headc)
hist(weight)
hist(length)
count(length > 50)
sum(length > 50)
sum(length > 100)
sum(length > 80)
sum(length > 40)
sum(length > 60)
sum(length > 60) / length(length)
1 - pnorm(q=60,mean=mean(length),sd=sd(length))
table(parity)
table(parity)/length(parity)
plot(length,weight)
plot(length,length)
plot(length,lengthc)
plot(length,headc)
plot(length,weight)
plot(length,headc)
source("../../RMDA.R")
pkCI(length)
pkCI(length,alpha=0.1)
pkCI(length,alpha=0.5)
pkCI(length,alpha=0.01)
pkCI(length,alpha=0.05)
View(pkCI)
View(births)
hist(weights())
hist(weights)
hist(weight)
